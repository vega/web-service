!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-arrays"),require("d3-dispatch"),require("d3-dsv")):"function"==typeof define&&define.amd?define("d3-request",["exports","d3-arrays","d3-dispatch","d3-dsv"],n):n(e.d3_request={},e.d3_arrays,e.d3_dispatch,e.d3_dsv)}(this,function(e,n,t,r){"use strict";function o(e,r){function o(){var e,n=f.status;if(!n&&u(f)||n>=200&&300>n||304===n){if(l)try{e=l.call(a,f)}catch(t){return void p.error.call(a,t)}else e=f;p.load.call(a,e)}else p.error.call(a,f)}var a,i,l,c,p=t.dispatch("beforesend","progress","load","error"),d=n.map(),f=new XMLHttpRequest;return"undefined"==typeof XDomainRequest||"withCredentials"in f||!/^(http(s)?:)?\/\//.test(e)||(f=new XDomainRequest),"onload"in f?f.onload=f.onerror=o:f.onreadystatechange=function(){f.readyState>3&&o()},f.onprogress=function(e){p.progress.call(a,e)},a={header:function(e,n){return e=(e+"").toLowerCase(),arguments.length<2?d.get(e):(null==n?d.remove(e):d.set(e,n+""),a)},mimeType:function(e){return arguments.length?(i=null==e?null:e+"",a):i},responseType:function(e){return arguments.length?(c=e,a):c},response:function(e){return l=e,a},get:function(e,n){return a.send("GET",e,n)},post:function(e,n){return a.send("POST",e,n)},send:function(n,t,r){return r||"function"!=typeof t||(r=t,t=null),r&&1===r.length&&(r=s(r)),f.open(n,e,!0),null==i||d.has("accept")||d.set("accept",i+",*/*"),f.setRequestHeader&&d.each(function(e,n){f.setRequestHeader(n,e)}),null!=i&&f.overrideMimeType&&f.overrideMimeType(i),null!=c&&(f.responseType=c),r&&a.on("error",r).on("load",function(e){r(null,e)}),p.beforesend.call(a,f),f.send(null==t?null:t),a},abort:function(){return f.abort(),a},on:function(){var e=p.on.apply(p,arguments);return e===p?a:e}},r?a.get(r):a}function s(e){return function(n,t){e(null==n?t:null)}}function u(e){var n=e.responseType;return n&&"text"!==n?e.response:e.responseText}function a(e,n){return function(t,r){var s=o(t).mimeType(e).response(n);return r?s.get(r):s}}function i(e,n){return function(t,r,s){arguments.length<3&&(s=r,r=null);var u=o(t).mimeType(e);return u.row=function(e){return arguments.length?u.response(l(n,r=e)):r},u.row(r),s?u.get(s):u}}function l(e,n){return function(t){return e.parse(t.responseText,n)}}var c=a("text/html",function(e){return document.createRange().createContextualFragment(e.responseText)}),p=a("application/json",function(e){return JSON.parse(e.responseText)}),d=a("text/plain",function(e){return e.responseText}),f=a("application/xml",function(e){return e.responseXML}),m=i("text/csv",r.csv),g=i("text/tab-separated-values",r.tsv),v="0.2.1";e.version=v,e.request=o,e.html=c,e.json=p,e.text=d,e.xml=f,e.csv=m,e.tsv=g});